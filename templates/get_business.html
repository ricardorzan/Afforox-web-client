{% extends 'base.html' %}
{% block title %} Afforox {% endblock title %}
{% block content %}
    {% load static %}
    {% block estilos-get_business %}
        <link rel="stylesheet" href="{% static 'css/home.css' %}">
        <link rel="stylesheet" href="{% static 'css/get_business.css' %}">
        <link rel="stylesheet" href="{% static 'css/register_business.css' %}">
        <link rel="stylesheet" href="{% static 'css/main.css' %}">
        <script type="text/javascript" src="{% static 'js/location.js' %}"></script>
    {% endblock %}
    <main>
        <section class="pb-1">
            <div class="row ">
                <div class="col-md-11 mx-auto">
                    <!-- Profile widget -->
                    <div class="bg-white shadow rounded overflow-hidden">
                        <div class="px-5 cover bg-black"
                             style="background-image: url('https://dummyimage.com/1920x380/343a40/6c757d')">
                            <div class="media align-items-end profile-head">
                                <!-- Foto de perfil -->
                                <div class="profile mr-3"><img
                                        src="https://dummyimage.com/250x250/343a40/6c757d"
                                        alt="..." width="250" class="rounded-circle mb-2 img-thumbnail">
                                </div>
                                <div class=" mb-5">
                                    <h1 class="mt-0 mb-0"> {{ negocio.nombre_completo }} </h1>
                                    <p class="mb-4"><i
                                            class="fas fa-map-marker-alt mr-2"></i> {{ negocio.tipo_negocio }} </p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-light p-4 d-flex justify-content-end text-center">
                            <ul class=" mb-0">
                                {% if username == negocio.usuario_correo %}
                                    <div class="col">
                                        <button class="btn btn-dark">
                                            <a class="bi-pencil"></a>
                                            Editar datos generales
                                        </button>
                                    </div>
                                {% endif %}
                                <li class="mt-5 list-inline-item">
                                    <h5 class="font-weight-bold mb-0 d-block">
                                        <a class="bi bi-facebook" href="#"></a>
                                    </h5><small
                                        class="text-muted"> <i
                                        class="fas fa-image mr-1"></i>{{ negocio.facebook }}</small>
                                </li>
                                <li class="list-inline-item">
                                    <h5 class="font-weight-bold mb-0 d-block">
                                        <a class="bi bi-instagram" href="#"></a>
                                    </h5><small
                                        class="text-muted"> <i
                                        class="fas fa-user mr-1"></i>{{ negocio.instagram }}</small>
                                </li>
                                <li class="list-inline-item">
                                    <h5 class="font-weight-bold mb-0 d-block">
                                        <a class="bi bi-whatsapp" href="#"></a>
                                    </h5><small
                                        class="text-muted"> <i
                                        class="fas fa-user mr-1"></i>{{ negocio.whatsapp }}</small>
                                </li>
                            </ul>
                        </div>

                        <nav>
                            <div class="nav nav-tabs" id="nav-tab" role="tablist">
                                <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home"
                                   role="tab" aria-controls="nav-home" aria-selected="true">Sucursales</a>
                                <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile"
                                   role="tab" aria-controls="nav-profile" aria-selected="false">Opiniones</a>
                            </div>
                        </nav>
                        <div class="tab-content" id="nav-tabContent">
                            <div class="tab-pane fade show active" id="nav-home" role="tabpanel"
                                 aria-labelledby="nav-home-tab">
                                <!-- Sucursales -->
                                <section>
                                    <div class="container px-4 px-lg-5 mt-5">
                                        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
                                            {% if username == negocio.usuario_correo %}
                                                <div class="col mb-5">
                                                    <div class="card h-100 w-75">
                                                        <div class="card-body bg-black bg-opacity-50 p-4 d-flex text-center py-5">
                                                            <!-- link -->
                                                            <a href="#" style="font-size: 100px"
                                                               data-toggle="modal" data-target="#addSucursalModal"
                                                               class="bi bi-plus-circle stretched-link h-100 w-100 my-5"></a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal fade" id="addSucursalModal" tabindex="-1"
                                                     role="dialog" aria-labelledby="addSucursalModal"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog modal-xl" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-body">
                                                                <div class="align-items-center g-5 py-3">
                                                                    <div class="mb-5">
                                                                        <h4 class="shadow text-white orange-flag rounded-3 p-2">
                                                                            Datos de la sucursal</h4>
                                                                    </div>
                                                                    <div class="w-75 mx-auto mb-3">
                                                                        {% csrf_token %}
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label">{{ sucursal_form.nombre_sucursal.label }}</label>
                                                                                {{ sucursal_form.nombre_sucursal }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label">{{ sucursal_form.telefono.label }}</label>
                                                                                {{ sucursal_form.telefono }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label">{{ sucursal_form.aforo_total.label }}</label>
                                                                                {{ sucursal_form.aforo_total }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label">{{ domicilio_form.pais.label }}</label>
                                                                                {{ domicilio_form.pais }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.estado.label }}</label>
                                                                                {{ domicilio_form.estado }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.ciudad.label }}</label>
                                                                                {{ domicilio_form.ciudad }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.municipio.label }}</label>
                                                                                {{ domicilio_form.municipio }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.calle.label }}</label>
                                                                                {{ domicilio_form.calle }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.numero_interior.label }}</label>
                                                                                {{ domicilio_form.numero_interior }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.numero_exterior.label }}</label>
                                                                                {{ domicilio_form.numero_exterior }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label ">{{ domicilio_form.colonia.label }}</label>
                                                                                {{ domicilio_form.colonia }}
                                                                            </div>
                                                                        </div>
                                                                        <div class="col text-end">
                                                                            <label class=" form-label"> Despues
                                                                                podrás agregar mas sucrusales a tu
                                                                                negocio </label>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-5">
                                                                        <h4 class="shadow text-white orange-flag rounded-3 p-2">
                                                                            Horarios y capacidad</h4>
                                                                    </div>
                                                                    <div class="w-75 mx-auto mb-5">
                                                                        {% csrf_token %}
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col-auto">
                                                                                <label class="form-label">{{ horario_form.dia.label }}</label>
                                                                                {{ horario_form.dia }}
                                                                            </div>
                                                                            <div class="col text-end">
                                                                                <label class=" form-label"> Despues
                                                                                    podrás ajustar los horarios por
                                                                                    día </label>
                                                                            </div>
                                                                        </div>
                                                                        <div class="row mx-auto mb-3">
                                                                            <div class="col">
                                                                                <label class="form-label">{{ horario_form.horario_apertura.label }}</label>
                                                                                {{ horario_form.horario_apertura }}
                                                                            </div>
                                                                            <div class="col">
                                                                                <label class="form-label">{{ horario_form.horario_cierre.label }}</label>
                                                                                {{ horario_form.horario_cierre }}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <div class="mb-5">
                                                                        <h4 class="shadow text-white orange-flag rounded-3 p-2">{{ sucursal_form.servicios.label }}
                                                                            para ofrecer</h4>
                                                                    </div>
                                                                    <div class="form-group w-75 mx-auto mb-5 row">
                                                                        {% csrf_token %}
                                                                        {% for value, text in sucursal_form.servicios.field.choices %}
                                                                            <div class="col-6">
                                                                                <label class="contenedor">{{ text }}
                                                                                    <input class=""
                                                                                           id="id_providers_{{ forloop.counter0 }}"
                                                                                           name="{{ sucursal_form.servicios.name }}"
                                                                                           type="checkbox"
                                                                                           value="{{ value }}"
                                                                                            {% if value in checked_providers %}
                                                                                           checked="checked"{% endif %}>
                                                                                    <span class="checkmark"></span>
                                                                                </label>
                                                                            </div>
                                                                        {% endfor %}
                                                                    </div>
                                                                    <div class="mb-5">
                                                                        <h4 class="shadow text-white orange-flag rounded-3 p-2">{{ sucursal_form.medidas.label }}
                                                                            de
                                                                            seguridad sanitarias</h4>
                                                                    </div>
                                                                    <div class="w-75 mx-auto mb-5 row">
                                                                        {% csrf_token %}
                                                                        {% for value, text in sucursal_form.medidas.field.choices %}
                                                                            <div class="col-6">
                                                                                <label class="contenedor">{{ text }}
                                                                                    <input class=""
                                                                                           id="id_providers_{{ forloop.counter0 }}"
                                                                                           name="{{ sucursal_form.medidas.name }}"
                                                                                           type="checkbox"
                                                                                           value="{{ value }}"
                                                                                            {% if value in checked_providers %}
                                                                                           checked="checked"{% endif %}>
                                                                                    <span class="checkmark"></span>
                                                                                </label>
                                                                            </div>
                                                                        {% endfor %}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button"
                                                                        data-dismiss="modal"
                                                                        class="btn btn-outline-secondary">
                                                                    Regresar
                                                                </button>
                                                                <button type="submit" class="btn btn-primary">
                                                                    Registrar
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endif %}
                                            {% for sucursal in negocio.sucursales %}
                                                <div class="col mb-5">
                                                    <div class="card h-100">
                                                        <!-- details-->
                                                        <h5 class=" text-white orange-flag rounded-top py-2 px-4">
                                                            Sucursal 1</h5>
                                                        <div class="card-body p-4">
                                                            <!-- name-->
                                                            <h2 class="fw-bolder"> {{ sucursal.nombre_sucursal }} </h2>
                                                            <!-- data-->
                                                            <h4 class="fw-normal"> {{ sucursal.domicilio.calle }}
                                                                #{{ sucursal.domicilio.numero_exterior }}
                                                                {{ sucursal.domicilio.colonia }},
                                                                {{ sucursal.domicilio.municipio }},
                                                            </h4>
                                                            <h5 class="text-muted">
                                                                {{ sucursal.domicilio.ciudad }},
                                                                {{ sucursal.domicilio.estado }},
                                                                {{ sucursal.domicilio.pais }}.
                                                            </h5>
                                                            <br>
                                                            <h4 class="fw-light cerrado">Cerrado</h4>
                                                            <!-- link -->
                                                            <a data-toggle="modal" data-target="#sucursalModal"
                                                               class="stretched-link"></a>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Modal -->
                                                <div class="modal fade" id="sucursalModal" tabindex="-1"
                                                     role="dialog" aria-labelledby="exampleModalLongTitle"
                                                     aria-hidden="true">
                                                    <div class="modal-dialog modal-xl" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-body">
                                                                <div class="row">
                                                                    <section class="col px-5 py-5">
                                                                        <!-- name-->
                                                                        <h1 class="fw-bolder">
                                                                            {{ sucursal.nombre_sucursal }}
                                                                        </h1>
                                                                        <div class="col mb-5">
                                                                            <div class="d-flex content-start text-warning">
                                                                                <a class="bi-star-fill"></a>
                                                                                <a class="bi-star-fill"></a>
                                                                                <a class="bi-star-fill"></a>
                                                                                <a class="bi-star-fill"></a>
                                                                                <a class="bi-star"></a>
                                                                            </div>
                                                                        </div>
                                                                        <h3 class="fw-light mb-4"> Aforo actual: </h3>
                                                                        <div class="d-flex flex-row">
                                                                            {% if username == negocio.usuario_correo %}
                                                                                <form action="{% url 'update_aforo' sucursal.sucursal_id 'minus' %}"
                                                                                      method="post">
                                                                                    {% csrf_token %}

                                                                                    <div class="p-2">
                                                                                        <button class="bi bi-dash btn-danger rounded-circle">
                                                                                        </button>
                                                                                    </div>
                                                                                </form>
                                                                            {% endif %}
                                                                            <div class="p-2">
                                                                                <h4 class="fw-light">
                                                                                    {{ sucursal.aforo_actual }}</h4>
                                                                            </div>
                                                                            <div class="p-2">
                                                                                <h4 class="fw-light">
                                                                                    /</h4>
                                                                            </div>
                                                                            <div class="p-2">
                                                                                <h4 class="fw-light">
                                                                                    {{ sucursal.aforo_total }}</h4>
                                                                            </div>
                                                                            {% if username == negocio.usuario_correo %}
                                                                                <form action="{% url 'update_aforo' sucursal.sucursal_id 'plus' %}"
                                                                                      method="post">
                                                                                    {% csrf_token %}

                                                                                    <div class="p-2">
                                                                                        <button class="bi bi-plus btn-success rounded-circle">
                                                                                        </button>
                                                                                    </div>
                                                                                </form>
                                                                            {% endif %}
                                                                        </div>
                                                                        <h3 class="mt-3"> Dirección: </h3>
                                                                        <h4 class=" fw-normal">
                                                                            {{ sucursal.domicilio.calle }}
                                                                            #{{ sucursal.domicilio.numero_exterior }}
                                                                            {{ sucursal.domicilio.colonia }},
                                                                            {{ sucursal.domicilio.municipio }}.
                                                                        </h4>
                                                                        <h5 class=" text-muted">
                                                                            {{ sucursal.domicilio.ciudad }},
                                                                            {{ sucursal.domicilio.estado }},
                                                                            {{ sucursal.domicilio.pais }}.
                                                                        </h5>
                                                                        <h3 class="mt-5"> Teléfono: </h3>
                                                                        <h4 class=" fw-normal"> {{ sucursal.telefono }}
                                                                        </h4>
                                                                        {% if username == negocio.usuario_correo %}
                                                                            <div class=" mt-5">
                                                                                <button class="btn btn-dark">
                                                                                    <a class="bi-pencil"></a>
                                                                                    Editar datos sucursal
                                                                                </button>
                                                                            </div>
                                                                        {% endif %}
                                                                    </section>
                                                                    <section class="my-5 mx-5 col bg-map">

                                                                    </section>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </section>
                            </div>
                            <div class="tab-pane fade" id="nav-profile" role="tabpanel"
                                 aria-labelledby="nav-profile-tab">
                                <!-- Opiniones -->
                                <section class=border-bottom">
                                    <div class="container px-5 my-5">
                                        <div class="card mb-5 mb-xl-0">
                                            <div class="card-body p-5">
                                                <div class="row">
                                                    <div class="col-auto">
                                                        <div class="mb-3 text-center">
                                                            <div class="col-lg-auto">
                                                                <img class="img-fluid rounded-circle mb-5 mb-lg-0"
                                                                     src="https://dummyimage.com/200x200/343a40/6c757d"
                                                                     alt="..."/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-auto ms-5 text-right">
                                                        <div class="mb-2 lead text-uppercase text-muted  afforox-subtitle">
                                                            Nombre persona
                                                        </div>
                                                        <div class="col mb-2">
                                                            <div class="d-flex content-start ">
                                                                <a class="bi-star-fill"></a>
                                                                <a class="bi-star-fill"></a>
                                                                <a class="bi-star-fill"></a>
                                                                <a class="bi-star-fill"></a>
                                                                <a class="bi-star"></a>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-auto">
                                                            <p class="lead mb-4 text-center">En tiempo real y de manera
                                                                automática en tus
                                                                instalaciones, desde
                                                                tu panel de administrador.</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
{% endblock content %}